'use strict';Object.defineProperty(exports,'__esModule',{value:!0});var _typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&'function'==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?'symbol':typeof obj},_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,'value'in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();var _react=require('react'),_react2=_interopRequireDefault(_react),_reactDom=require('react-dom'),_reactClass=require('react-class'),_reactClass2=_interopRequireDefault(_reactClass),_objectAssign=require('object-assign'),_objectAssign2=_interopRequireDefault(_objectAssign),_reactNotifyResize=require('react-notify-resize'),_join=require('../join'),_join2=_interopRequireDefault(_join),_assignDefined=require('../assignDefined'),_assignDefined2=_interopRequireDefault(_assignDefined),_bemFactory=require('../bemFactory'),_bemFactory2=_interopRequireDefault(_bemFactory),_FlexiBox=require('./FlexiBox'),_FlexiBox2=_interopRequireDefault(_FlexiBox);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError('Cannot call a class as a function')}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return call&&('object'==typeof call||'function'==typeof call)?call:self}function _inherits(subClass,superClass){if('function'!=typeof superClass&&null!==superClass)throw new TypeError('Super expression must either be null or a function, not '+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var toNumber=function toNumber(a){return parseInt(a,10)},stopPropagation=function stopPropagation(a){return a.stopPropagation()},getBorderPaddingSize=function getBorderPaddingSize(a){var b=global.getComputedStyle(a);return{left:toNumber(b.borderLeftWidth)+toNumber(b.paddingLeft),right:toNumber(b.borderRightWidth)+toNumber(b.paddingRight),top:toNumber(b.borderTopWidth)+toNumber(b.paddingTop),bottom:toNumber(b.borderBottomWidth)+toNumber(b.paddingBottom)}},CLASS_NAME='react-tab-panel__tab-title',bem=(0,_bemFactory2.default)(CLASS_NAME),m=function m(a){return bem(null,a)},invert=function invert(_ref){var a=_ref.width,b=_ref.height;return{height:a,width:b}},HIDDEN_STYLE={position:'absolute',visibility:'hidden',width:'auto',minWidth:'auto',maxWidth:'auto',height:'auto',minHeight:'auto',maxHeight:'auto'};var TabTitle=function(_Component){function TabTitle(a){_classCallCheck(this,TabTitle);var _this=_possibleConstructorReturn(this,Object.getPrototypeOf(TabTitle).call(this,a));return _this.state={style:{},size:{},hiddenSize:{},innerSize:{}},_this.state={style:{},size:{},hiddenSize:{},innerSize:{}},_this}return _inherits(TabTitle,_Component),_createClass(TabTitle,[{key:'prepareClassName',value:function prepareClassName(a){return(0,_join2.default)(a.className,CLASS_NAME,a.first&&m('first'),a.last&&m('last'),a.vertical&&m('vertical'),a.active&&m('active'),a.beforeActive&&m('before-active'),a.afterActive&&m('after-active'),a.disabled&&m('disabled'),a.closeable&&m('closeable'),a.tabEllipsis&&m('ellipsis'))}},{key:'prepareInnerClassName',value:function prepareInnerClassName(a){return(0,_join2.default)(bem('inner'),a.active&&bem('inner','active'),a.tabEllipsis&&bem('inner','ellipsis'))}},{key:'prepareChildren',value:function prepareChildren(a){var b=(void 0===a.tabTitle?a.children:a.tabTitle)||'\xA0';return a.closeable?[b,this.renderCloseIcon()]:b}},{key:'renderCloseIcon',value:function renderCloseIcon(){var a=_defineProperty({},this.p.activateEvent,stopPropagation);return _react2.default.createElement('div',_extends({},a,{onClick:this.onClose,title:'Close tab',className:bem('close-icon')}),_react2.default.createElement('svg',{className:bem('close-icon-svg'),height:'14',width:'14',viewBox:'0 0 24 24',xmlns:'http://www.w3.org/2000/svg'},_react2.default.createElement('path',{d:'M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z'}),_react2.default.createElement('path',{d:'M0 0h24v24H0z',fill:'none'})))}},{key:'onClose',value:function onClose(a){'onClick'==this.p.activateEvent&&a.stopPropagation(),this.props.onClose(a)}},{key:'prepareInnerStyle',value:function prepareInnerStyle(a){var b=a.tabStyle,c=('function'==typeof b?b(a):b)||{};return(0,_objectAssign2.default)({},c)}},{key:'prepareStyle',value:function prepareStyle(a,b){var c=(0,_objectAssign2.default)({},a.style);if(a.vertical&&function(){//on vertical tabs - the name of the dimensions are inversed
var d={height:'width',minHeight:'minWidth',maxHeight:'maxWidth'};Object.keys(d).forEach(function(f){//NOTE: inner is rotated!
var g=b[f];void 0!==g&&(c[f]=g,delete b[f],b[d[f]]=g)})}(),'stretch'===a.tabAlign){//if we are in stretch mode, the size
//dimensions should be set on the style object (if they are specified)
//not on the innerStyle, since the main div will now give the dimension
var _d=a.vertical?['height','minHeight','maxHeight']:['width','minWidth','maxWidth'];_d.forEach(function(f){var g=b[f];void 0!==g&&(c[f]=g,delete b[f])})}return c}},{key:'render',value:function render(){var _this2=this,a=this.p=(0,_objectAssign2.default)({},this.props);a.activateEvent=a.activateEvent||'onClick';var b=a.index,c=this.prepareClassName(a),d=this.prepareInnerClassName(a),f=this.prepareChildren(a),_state=this.state,g=_state.innerSize,h=_state.hiddenSize,i=this.prepareInnerStyle(a),j=this.prepareStyle(a,i);a.vertical&&('stretch'==a.tabAlign?(j.minWidth=g.height,j.height=h.width):(j.minWidth=g.height,j.height=g.width));var k=(0,_objectAssign2.default)({},a,_defineProperty({style:j,disabled:null,className:c},a.activateEvent,this.onActivate)),l={key:'inner',style:i,className:d,children:[f,a.vertical&&_react2.default.createElement(_reactNotifyResize.NotifyResize,{measureSize:this.measureInnerSize,onResize:this.onInnerResize,notifyOnMount:!0})]};if(a.vertical&&'stretch'===a.tabAlign){var _ret2=function(){var o=_react2.default.createElement('div',{key:'innerHidden',className:(0,_join2.default)(d,bem('inner','hidden')),style:(0,_objectAssign2.default)({},i,HIDDEN_STYLE)},f,_react2.default.createElement(_reactNotifyResize.NotifyResize,{onResize:_this2.onHiddenResize,notifyOnMount:!0}));return{v:_react2.default.createElement(_FlexiBox2.default,k,function(_ref2){var p=_ref2.width,q=_ref2.height;return q=Math.max(q||0,h.width||0),[_react2.default.createElement('div',_extends({},l,{style:(0,_objectAssign2.default)({},i,{width:q})})),o]})}}();if('object'==('undefined'==typeof _ret2?'undefined':_typeof(_ret2)))return _ret2.v}return _react2.default.createElement('div',k,_react2.default.createElement('div',l))}},{key:'measureInnerSize',value:function measureInnerSize(a){var b=a.offsetHeight,c=a.offsetWidth;if(this.props.vertical){var d=getBorderPaddingSize(a.parentNode);b+=d.left+d.right}return{width:c,height:b}}},{key:'onInnerResize',value:function onInnerResize(_ref3){var a=_ref3.width,b=_ref3.height;this.setState({innerSize:{width:a,height:b}})}},{key:'onHiddenResize',value:function onHiddenResize(_ref4){var a=_ref4.width,b=_ref4.height;this.setState({hiddenSize:{width:a,height:b}})}},{key:'onActivate',value:function onActivate(a){var b=this.props.activateEvent||'onClick',c=(0,_reactDom.findDOMNode)(this);'function'==typeof this.props[b]&&this.props[b](a),this.props.disabled||this.props.onActivate(c)}}]),TabTitle}(_reactClass2.default);exports.default=TabTitle;TabTitle.propTypes={disabled:_react.PropTypes.bool,tabEllipsis:_react.PropTypes.bool,activateEvent:_react.PropTypes.oneOf(['onClick','onMouseEnter','onMouseDown']),onActivate:_react.PropTypes.func},TabTitle.defaultProps={onActivate:function onActivate(){}};